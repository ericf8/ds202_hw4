---
title: "EricFriesth_hw4"
author: "Eric Friesth"
date: "10/29/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```
## Liquor Sales in Iowa 

### Part 1

```{r}

if (file.exists("alcohol.rds")) {
  data <- readRDS("alcohol.rds")
} else {
  url <- "https://github.com/lbchu/ds202_labs/raw/master/ames.csv"
  data <- readr::read_csv(url)
  saveRDS(data, file="alcohol.rds")
} 

```

### Part 2 Data Cleaning

```{r}

print(data, width = Inf)

names(data)

```

Replace current column names to be the same names but replacing the spaces (" ") with an underscore ("_")

```{r}

dataClean = data

names(dataClean) = sub(" ", "_", names(dataClean)) # replaces the first space in the column name with "_"
names(dataClean) = sub(" ", "_", names(dataClean)) # replaces the second space in the column name with "_"

names(dataClean) # show the updated column names

```

Split geographic latitute and longitude from the variable Store_Location using strsplit()

```{r}
library(dplyr)
library (tidyverse)

loc_split = strsplit(as.character(dataClean$Store_Location), split = " ") # split the Store Location column 
dataClean = transform(dataClean, Point = sapply(loc_split, "[", 1), Latitude = sapply(loc_split, "[", 2), Longitude = sapply(loc_split, "[", 3))

dataClean = dataClean[-8] # drop column Store_Location
dataClean = dataClean[-24] # drop column Point

dataClean$Latitude = gsub("\\(", "", dataClean$Latitude) # removed "(" from all rows in column Latitude
dataClean$Longitude = gsub("\\)", "", dataClean$Longitude) # removed ")" from all rows in column Longitude
dataClean$Invoice.Item_Number = gsub("INV-", "", dataClean$Invoice.Item_Number) # removed "INV-" from all rows in column Invoice.Item_Number

```

Checking and changing datatype of variables

```{r}

str(dataClean) # a look into the datatypes of each column

dataClean = transform(dataClean, Invoice.Item_Number = as.numeric(Invoice.Item_Number), Vendor_Number = as.numeric(Vendor_Number), Latitude = as.numeric(Latitude), Longitude = as.numeric(Longitude))

str(dataClean) # observe the new datatypes

```

Extract the Year, Month, and Day from variable Date

```{r}

date_split = strsplit(as.character(dataClean$Date), split = "/") # splits the date column into three separate ones off the character "/"
dataClean = transform(dataClean, Month = sapply(date_split, "[", 1), Day = sapply(date_split, "[", 2), Year = sapply(date_split, "[", 3))

dataClean = dataClean[-2]

```

### Part 3 First OVerview

Scatterplot of Latitude and Longitude of store locations

```{r}

library(ggplot2)

ggplot(dataClean, aes(x = Latitude, y = Longitude)) + geom_point() + labs(title = "Scatterplot of Latitude by Longitude", x = "Latitude", y = "Longitude")

```

Scatterplot of Liquor Category by its Volume Sold (Gallons)

```{r}

ggplot(dataClean, aes(x = Category_Name, y = Volume_Sold_.Gallons.)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))

```










